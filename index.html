<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>高鐵台中 ⇄ 台北 票價試算</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 2rem;
      background: #f9f9f9;
    }
    h1 { color: #333; }
    label { display: block; margin-top: 1rem; }
    input { margin-top: 0.5rem; padding: 0.3rem; }
    button {
      margin-top: 1.5rem;
      padding: 0.5rem 1rem;
      font-size: 1rem;
      cursor: pointer;
    }
    .result {
      margin-top: 2rem;
      padding: 1rem;
      background: #fff;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>高鐵台中 ⇄ 台北 票價試算</h1>

  <label>
    起始日期：
    <input type="date" id="startDate" />
  </label>
  <label>
    結束日期：
    <input type="date" id="endDate" />
  </label>
  <label>
    假期天數（含週末）：
    <input type="number" id="holidayDays" value="0" />
  </label>
  <button onclick="calculate()">開始計算</button>

  <div class="result" id="result"></div>

  <script>
    const BASE_PRICE = 675;
    const FIXED_FARE = 19845;

    function calculate() {
      const startDate = new Date(document.getElementById("startDate").value);
      const endDate = new Date(document.getElementById("endDate").value);
      const holidayDays = parseInt(document.getElementById("holidayDays").value) || 0;

      if (!startDate || !endDate || startDate > endDate) {
        alert("請輸入正確的日期區間！");
        return;
      }

      const diffTime = endDate - startDate;
      const days = Math.floor(diffTime / (1000 * 60 * 60 * 24)) + 1;
      const workDays = days - holidayDays;
      const totalTrips = workDays * 2;

      let results = {};

      // 定期票（每30天一張）
      const periods = Math.ceil(days / 30);
      results["定期票"] = periods * FIXED_FARE;

      // 30天回數票
      const fare30 = 0.82 * BASE_PRICE;
      const fullSets30 = Math.floor(totalTrips / 10);
      const remaining30 = totalTrips % 10;
      results["30天回數票"] = fullSets30 * fare30 * 10 + remaining30 * BASE_PRICE;

      // 60天回數票
      const fare60 = 0.92 * BASE_PRICE;
      const fullSets60 = Math.floor(totalTrips / 8);
      const remaining60 = totalTrips % 8;
      results["60天回數票"] = fullSets60 * fare60 * 8 + remaining60 * BASE_PRICE;

      // 全自由座
      results["全自由座"] = totalTrips * BASE_PRICE;

      // 找出最便宜
      const cheapest = Object.entries(results).reduce((a, b) => a[1] < b[1] ? a : b);

      // 顯示結果
      let output = `<h2>結果</h2>`;
      output += `<p>期間共 ${days} 天（工作日 ${workDays} 天，每天來回 2 次，共 ${totalTrips} 趟）</p>`;
      for (const [k, v] of Object.entries(results)) {
        output += `<p>${k}：${v.toFixed(0)} 元</p>`;
      }
      output += `<h3>最划算方案：${cheapest[0]}（${cheapest[1].toFixed(0)} 元）</h3>`;
      document.getElementById("result").innerHTML = output;
    }
  </script>
</body>
</html>
