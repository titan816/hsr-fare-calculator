<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.1">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype html&gt;</p>
<p class="p1">&lt;html lang="zh-Hant"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta charset="utf-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;title&gt;高鐵台中↔台北 試算器&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>:root{font-family: -apple-system, "Segoe UI", Roboto, "Noto Sans TC", "PingFang TC", "Microsoft JhengHei", "Helvetica Neue", Arial; color:#111}</p>
<p class="p1"><span class="Apple-converted-space">    </span>body{max-width:880px;margin:28px auto;padding:22px;background:#fbfbfc;border-radius:12px;box-shadow:0 6px 22px rgba(20,20,30,0.06)}</p>
<p class="p1"><span class="Apple-converted-space">    </span>h1{font-size:20px;margin:0 0 8px}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.card{background:#fff;padding:14px;border-radius:10px;margin-top:12px;border:1px solid #ececec}</p>
<p class="p1"><span class="Apple-converted-space">    </span>label{display:block;margin:10px 0 6px;font-weight:600}</p>
<p class="p1"><span class="Apple-converted-space">    </span>input[type=date], input[type=number]{padding:8px;border-radius:6px;border:1px solid #d8d8d8;width:220px}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}</p>
<p class="p1"><span class="Apple-converted-space">    </span>button{background:#0b69ff;color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer}</p>
<p class="p1"><span class="Apple-converted-space">    </span>table{width:100%;border-collapse:collapse;margin-top:12px}</p>
<p class="p1"><span class="Apple-converted-space">    </span>th,td{padding:10px;border-bottom:1px solid #eee;text-align:left}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.best{background:linear-gradient(90deg,#e6f6ff,#f7fbff);border-left:4px solid #0077ff}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.muted{color:#666;font-size:13px}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.small{font-size:13px}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.switch{display:inline-flex;align-items:center;gap:8px}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.note{font-size:13px;color:#444;margin-top:8px}</p>
<p class="p1"><span class="Apple-converted-space">    </span>.danger{color:#c33}</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;h1&gt;高鐵台中 ↔ 台北 費用試算器&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;p class="muted"&gt;說明：以您輸入的日期區間與假期（或自動排除週末）計算。每天假設搭乘「來回各一次（2次）」。本試算器以「自由座單程 675 元」與您指定的優惠條件計算。&lt;/p&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;div class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;label&gt;起始日期&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;&lt;input id="start" type="date" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;label style="margin-left:8px"&gt;結束日期&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;input id="end" type="date" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div style="margin-top:10px" class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;label&gt;假期（含六日）天數（手動輸入）&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;input id="holidays" type="number" min="0" value="0" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;label&gt;或啟用自動排除週末（六日）&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="switch"&gt;&lt;input id="autoWeekend" type="checkbox" /&gt; &lt;span class="small"&gt;勾選：自動計算區間內的週六、週日並視為假期&lt;/span&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div style="margin-top:12px" class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button id="calc"&gt;開始試算&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;button id="reset" style="background:#f0f0f0;color:#111"&gt;重設&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">      </span>&lt;div style="margin-left:auto" class="muted small"&gt;版本：single-file (HTML + JS)&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div id="result" style="display:none;margin-top:14px"&gt;&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="note"&gt;提示：&lt;span class="danger"&gt;實際票價與購票規則以台灣高鐵官網公告為準&lt;/span&gt;。此試算器只做預估比較，不含訂位費、手續費與特殊折扣。&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>// 參數（若要變更數值可在此修改）</p>
<p class="p1"><span class="Apple-converted-space">    </span>const BASE_PRICE = 675; // 自由座單程</p>
<p class="p1"><span class="Apple-converted-space">    </span>const PERIODIC_FARE = 19845; // 定期票 30 天不限次數</p>
<p class="p1"><span class="Apple-converted-space">    </span>const UNIT_30 = 10; // 30天回數票 次數上限</p>
<p class="p1"><span class="Apple-converted-space">    </span>const UNIT_60 = 8;<span class="Apple-converted-space">  </span>// 60天回數票 次數上限</p>
<p class="p1"><span class="Apple-converted-space">    </span>const DISCOUNT_30 = 0.82; // 30天回數票 折扣</p>
<p class="p1"><span class="Apple-converted-space">    </span>const DISCOUNT_60 = 0.92; // 60天回數票 折扣</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>const $ = id =&gt; document.getElementById(id);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function inclusiveDays(start, end){</p>
<p class="p1"><span class="Apple-converted-space">      </span>const msPerDay = 24*60*60*1000;</p>
<p class="p1"><span class="Apple-converted-space">      </span>return Math.floor((end - start) / msPerDay) + 1;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function countWeekendDays(start, end){</p>
<p class="p1"><span class="Apple-converted-space">      </span>let s = new Date(start.getFullYear(), start.getMonth(), start.getDate());</p>
<p class="p1"><span class="Apple-converted-space">      </span>let e = new Date(end.getFullYear(), end.getMonth(), end.getDate());</p>
<p class="p1"><span class="Apple-converted-space">      </span>let count = 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>for(let d = new Date(s); d &lt;= e; d.setDate(d.getDate() + 1)){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const wd = d.getDay(); // 0 Sun, 6 Sat</p>
<p class="p1"><span class="Apple-converted-space">        </span>if(wd === 0 || wd === 6) count++;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p1"><span class="Apple-converted-space">      </span>return count;</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function calcCosts(days, holidayDays){</p>
<p class="p1"><span class="Apple-converted-space">      </span>const travelDays = Math.max(0, days - holidayDays); // 實際搭乘天數</p>
<p class="p1"><span class="Apple-converted-space">      </span>const totalTrips = travelDays * 2; // 每天來回各一次</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 定期票（按整個區間長度計算需幾張）</p>
<p class="p1"><span class="Apple-converted-space">      </span>const periods = Math.ceil(days / 30);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const costPeriodic = periods * PERIODIC_FARE;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 30 天回數票</p>
<p class="p1"><span class="Apple-converted-space">      </span>const fullSets30 = Math.floor(totalTrips / UNIT_30);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rem30 = totalTrips % UNIT_30;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const cost30 = fullSets30 * (UNIT_30 * DISCOUNT_30 * BASE_PRICE) + rem30 * BASE_PRICE;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 60 天回數票</p>
<p class="p1"><span class="Apple-converted-space">      </span>const fullSets60 = Math.floor(totalTrips / UNIT_60);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const rem60 = totalTrips % UNIT_60;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const cost60 = fullSets60 * (UNIT_60 * DISCOUNT_60 * BASE_PRICE) + rem60 * BASE_PRICE;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 全部用單次票</p>
<p class="p1"><span class="Apple-converted-space">      </span>const costSingle = totalTrips * BASE_PRICE;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>return {</p>
<p class="p1"><span class="Apple-converted-space">        </span>travelDays, totalTrips,</p>
<p class="p1"><span class="Apple-converted-space">        </span>'定期票': costPeriodic,</p>
<p class="p1"><span class="Apple-converted-space">        </span>'30天回數票': cost30,</p>
<p class="p1"><span class="Apple-converted-space">        </span>'60天回數票': cost60,</p>
<p class="p1"><span class="Apple-converted-space">        </span>'全自由座': costSingle</p>
<p class="p1"><span class="Apple-converted-space">      </span>};</p>
<p class="p1"><span class="Apple-converted-space">    </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>function fmt(n){ return n.toLocaleString('zh-TW'); }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>$('calc').addEventListener('click', ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">      </span>const s = $('start').value;</p>
<p class="p1"><span class="Apple-converted-space">      </span>const e = $('end').value;</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(!s || !e){ alert('請選擇起訖日期'); return; }</p>
<p class="p1"><span class="Apple-converted-space">      </span>const sd = new Date(s);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const ed = new Date(e);</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(ed &lt; sd){ alert('結束日不得早於起始日'); return; }</p>
<p class="p1"><span class="Apple-converted-space">      </span>const days = inclusiveDays(sd, ed);</p>
<p class="p1"><span class="Apple-converted-space">      </span>const auto = $('autoWeekend').checked;</p>
<p class="p1"><span class="Apple-converted-space">      </span>let holidays = parseInt($('holidays').value) || 0;</p>
<p class="p1"><span class="Apple-converted-space">      </span>if(auto){</p>
<p class="p1"><span class="Apple-converted-space">        </span>holidays = countWeekendDays(sd, ed);</p>
<p class="p1"><span class="Apple-converted-space">        </span>// 同時把欄位數字更新給使用者參考</p>
<p class="p1"><span class="Apple-converted-space">        </span>$('holidays').value = holidays;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>const costs = calcCosts(days, holidays);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// 找最小值</p>
<p class="p1"><span class="Apple-converted-space">      </span>const entries = Object.entries(costs).filter(([k])=&gt; ['定期票','30天回數票','60天回數票','全自由座'].includes(k));</p>
<p class="p1"><span class="Apple-converted-space">      </span>const minEntry = entries.reduce((acc, cur)=&gt; cur[1] &lt; acc[1] ? cur : acc, entries[0]);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>// Build result HTML</p>
<p class="p1"><span class="Apple-converted-space">      </span>let html = `&lt;div class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div class="small muted"&gt;區間共 ${days} 天；自動排除週末：${auto ? '是' : '否'}；假期（六日含）：${holidays} 天；實際搭乘日 ${costs.travelDays} 天，總搭程次 ${costs.totalTrips} 次。&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;table&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;thead&gt;&lt;tr&gt;&lt;th&gt;票種&lt;/th&gt;&lt;th&gt;總費用 (NT$)&lt;/th&gt;&lt;th&gt;平均每次花費 (NT$)&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">          </span>&lt;tbody&gt;`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>for(const key of ['定期票','30天回數票','60天回數票','全自由座']){</p>
<p class="p1"><span class="Apple-converted-space">        </span>const val = costs[key];</p>
<p class="p1"><span class="Apple-converted-space">        </span>const avg = costs.totalTrips ? Math.round(val / costs.totalTrips) : 0;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const bestClass = (key === minEntry[0]) ? 'best' : '';</p>
<p class="p1"><span class="Apple-converted-space">        </span>html += `&lt;tr class="${bestClass}"&gt;&lt;td&gt;${key}&lt;/td&gt;&lt;td&gt;NT$ ${fmt(Math.round(val))}&lt;/td&gt;&lt;td class="small"&gt;NT$ ${fmt(avg)}&lt;/td&gt;&lt;/tr&gt;`;</p>
<p class="p1"><span class="Apple-converted-space">      </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>html += `&lt;/tbody&gt;&lt;/table&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div style="margin-top:10px;"&gt;最划算方案：&lt;strong&gt;${minEntry[0]}&lt;/strong&gt;，總費用 NT$ ${fmt(Math.round(minEntry[1]))}&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">      </span>const $r = $('result');</p>
<p class="p1"><span class="Apple-converted-space">      </span>$r.innerHTML = html;</p>
<p class="p1"><span class="Apple-converted-space">      </span>$r.style.display = 'block';</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>$('reset').addEventListener('click', ()=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">      </span>$('start').value='';$('end').value='';$('holidays').value=0;$('autoWeekend').checked=false;$('result').style.display='none';</p>
<p class="p1"><span class="Apple-converted-space">    </span>});</p>
<p class="p1"><span class="Apple-converted-space">  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
